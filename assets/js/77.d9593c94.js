(window.webpackJsonp=window.webpackJsonp||[]).push([[77],{429:function(s,a,t){"use strict";t.r(a);var e=t(48),r=Object(e.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"配置-mysql"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置-mysql"}},[s._v("#")]),s._v(" 配置 MySQL")]),s._v(" "),t("p"),t("div",{staticClass:"table-of-contents"},[t("ul",[t("li",[t("a",{attrs:{href:"#为翼龙创建数据库"}},[s._v("为翼龙创建数据库")]),t("ul",[t("li",[t("a",{attrs:{href:"#登录"}},[s._v("登录")])]),t("li",[t("a",{attrs:{href:"#创建用户"}},[s._v("创建用户")])]),t("li",[t("a",{attrs:{href:"#创建数据库"}},[s._v("创建数据库")])]),t("li",[t("a",{attrs:{href:"#分配权限"}},[s._v("分配权限")])])])]),t("li",[t("a",{attrs:{href:"#为节点创建数据库主机"}},[s._v("为节点创建数据库主机")]),t("ul",[t("li",[t("a",{attrs:{href:"#创建用户"}},[s._v("创建用户")])]),t("li",[t("a",{attrs:{href:"#分配权限"}},[s._v("分配权限")])]),t("li",[t("a",{attrs:{href:"#允许外部访问数据库"}},[s._v("允许外部访问数据库")])])])])])]),t("p"),s._v(" "),t("h2",{attrs:{id:"为翼龙创建数据库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#为翼龙创建数据库"}},[s._v("#")]),s._v(" 为翼龙创建数据库")]),s._v(" "),t("p",[s._v("MySQL 是翼龙面板的核心组件，但如果你以前没有配置过 MySQL，你可能会在配置的过程中感到混乱。这是一个非常基础的教程，只说明如何使用 MySQL 为面板配置好一个数据库。如果你有兴趣学习更多关于 MySQL 的知识，可以在网上找到很多很好的教程。")]),s._v(" "),t("h3",{attrs:{id:"登录"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#登录"}},[s._v("#")]),s._v(" 登录")]),s._v(" "),t("p",[s._v("首先我们需要登录到 MySQL 的命令行，我们需要在此命令行执行一些语句来配置数据库。登录到 MySQL 命令行十分简单，只需要输入下面的命令，然后提供安装 MySQL 时设置的 root 账户密码。若没有设置密码，您很可能只需按 Enter (回车) 键，因为没有设置密码")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("mysql -u root -p\n")])])]),t("h3",{attrs:{id:"创建用户"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建用户"}},[s._v("#")]),s._v(" 创建用户")]),s._v(" "),t("p",[s._v("为了安全和适应 MySQL 5.7 的改变，你需要为面板创建一个新用户，为了做到这一点，我们需要让 MySQL 知道 mysql 数据库信息。")]),s._v(" "),t("p",[s._v("接下来，我们会创建一个名为 "),t("code",[s._v("pterodactyl")]),s._v(" 的用户，并允许从 localhost 登录，你也可以用 "),t("code",[s._v("%")]),s._v(" 来允许所有IP登录或者输入数字IP。同样的，我们还将密码设置为 "),t("code",[s._v("somePassword")]),s._v("。")]),s._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 记得将下面的 'somePassword' 设为特定于此账号的独有密码。")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("USER")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'pterodactyl'")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@'127.0.0.1'")]),s._v(" IDENTIFIED "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BY")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'somePassword'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("h3",{attrs:{id:"创建数据库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建数据库"}},[s._v("#")]),s._v(" 创建数据库")]),s._v(" "),t("p",[s._v("接下来, 我们需要为面板创建一个数据库. 在本教程中，我们会把数据库命名为 "),t("code",[s._v("panel")]),s._v(", 但你也可以将此数据库命名为其他名字。")]),s._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DATABASE")]),s._v(" panel"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("h3",{attrs:{id:"分配权限"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#分配权限"}},[s._v("#")]),s._v(" 分配权限")]),s._v(" "),t("p",[s._v("最后，我们需要让 MySQL 知道，翼龙用户有权限访问去访问此数据库。要做到这一点，我们只需要运行下面的命令。如果你还想把这个 MySQL 用于面板上的数据库主机。你只需要在命令中加入 "),t("code",[s._v("WITH GRANT OPTION")]),s._v(" (下面的命令已增加此选项)。如果你不打算把这个用户用作面板上的数据库主机，则可以将其删除。")]),s._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("GRANT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ALL")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("PRIVILEGES")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" panel"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TO")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'pterodactyl'")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@'127.0.0.1'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WITH")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("GRANT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("OPTION")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("h2",{attrs:{id:"为节点创建数据库主机"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#为节点创建数据库主机"}},[s._v("#")]),s._v(" 为节点创建数据库主机")]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),t("p",[s._v("本节介绍如何创建一个具有创建和修改用户权限的 MySQL 用户，这允许面板在给定主机上创建每个服务器的数据库。")])]),s._v(" "),t("h3",{attrs:{id:"创建用户-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建用户-2"}},[s._v("#")]),s._v(" 创建用户")]),s._v(" "),t("p",[s._v("如果您的数据库与面板或者守护进程安装在不同的主机上，请确保使用面板运行的主机IP地址(或者直接使用通配符 "),t("code",[s._v("%")]),s._v(")而不是 "),t("code",[s._v("127.0.0.1")]),s._v("。 否则你会收到一个连接拒绝的错误。")]),s._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 记得把 'pterodactyluser' 和 'somePassword' 设为独有的账号密码。")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("USER")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'pterodactyluser'")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@'127.0.0.1'")]),s._v(" IDENTIFIED "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BY")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'somepassword'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("h3",{attrs:{id:"分配权限-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#分配权限-2"}},[s._v("#")]),s._v(" 分配权限")]),s._v(" "),t("p",[s._v("下面的命令将使你新创建的用户具备创建其他用户，以及创建和销毁数据库的能力。如上所述，确保 "),t("code",[s._v("127.0.0.1")]),s._v(" 换成跟上面命令中使用的 IP 地址同样喔~")]),s._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("GRANT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ALL")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("PRIVILEGES")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TO")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'pterodactyluser'")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@'127.0.0.1'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WITH")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("GRANT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("OPTION")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("h3",{attrs:{id:"允许外部访问数据库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#允许外部访问数据库"}},[s._v("#")]),s._v(" 允许外部访问数据库")]),s._v(" "),t("p",[s._v("你有可能需要允许外部访问这个 MySQL 实例，以便允许服务器连接到它。要做到这一点，我们需要修改 "),t("code",[s._v("my.cnf")]),s._v(" 来达到这个目的，它的位置取决于你的操作系统和 MySQL 安装方式，你可以输入 "),t("code",[s._v("find /etc -iname my.cnf")]),s._v(" 来找到它。")]),s._v(" "),t("p",[s._v("打开 "),t("code",[s._v("my.cnf")]),s._v("，将下面的文本添加到文件底部并保存：")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("[mysqld]\nbind-address=0.0.0.0\n")])])]),t("p",[s._v("重启 MySQL/MariaDB 以应用这些变化。这将覆盖默认的 MySQL 配置，在默认情况下，它只接受来自 localhost 的请求。更新这个将允许所有接口的连接，因此也允许外部连接。请确保在你的防火墙中允许 MySQL 端口（默认为3306）。")]),s._v(" "),t("p",[s._v("如果你的数据库和 Wings 在同一台主机上，并且不需要外部访问，你也可以使用 "),t("code",[s._v("docker0")]),s._v(" 接口的IP地址而不是 "),t("code",[s._v("127.0.0.1")]),s._v("。这个IP地址可以通过运行 "),t("code",[s._v("ip addr | grep docker0")]),s._v(" 找到，它可能看起来像 "),t("code",[s._v("172.x.x.x")]),s._v("。")])])}),[],!1,null,null,null);a.default=r.exports}}]);